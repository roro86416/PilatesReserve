# PilatesReserve å°ˆé¡Œé–‹ç™¼ç­†è¨˜

## ğŸ¯ é è¨ˆåŠŸèƒ½ç›®æ¨™

### ä¸€ã€ æœƒå“¡ç«¯

- **ç·šä¸Šé ç´„èª²ç¨‹**ï¼šå¿«é€Ÿé¸æ“‡é©åˆæˆ‘çš„æ™‚æ®µèˆ‡è€å¸«ã€‚
- **é ç´„æé†’åŠŸèƒ½**ï¼šä¸æœƒå¿˜è¨˜ä¸Šèª²æ™‚é–“ã€‚
- **é ç´„å–æ¶ˆæˆ–æ”¹æœŸåŠŸèƒ½**ï¼šéˆæ´»èª¿æ•´è¡Œç¨‹ã€‚

### äºŒã€ æ•™ç·´ç«¯

- **è¨­å®šæˆ–æ›´æ”¹é–‹èª²æ™‚æ®µçš„åŠŸèƒ½**ï¼šè‡ªä¸»å®‰æ’ä¸Šèª²æ™‚é–“ã€‚
- **æŸ¥çœ‹è‡ªå·±èª²è¡¨èˆ‡é ç´„åå–®çš„åŠŸèƒ½**ï¼šæ¸…æ¥šçŸ¥é“æ¯å¤©çš„ä¸Šèª²å®‰æ’ã€‚
- **æ ¸éŠ·èª²ç¨‹**ï¼šç¢ºèªå·²å®Œæˆä¸Šèª²ã€‚
- **å°å­¸å“¡é€²è¡Œæ¨™ç±¤çš„åŠŸèƒ½**ï¼šæ¨™è¨˜éœ€ç‰¹åˆ¥æ³¨æ„çš„å­¸å“¡ï¼ˆå¦‚é»‘åå–®ã€æˆ‘çš„æœ€æ„›ï¼‰ã€‚

---

## ğŸš€ ç›®å‰é–‹ç™¼é€²åº¦

- **å‰ç«¯è¦–è¦º**ï¼šå·²å®Œæˆç°¡æ˜“å‰ç«¯çš„è¦–è¦ºã€‚
- **æœƒå“¡ç«¯åŠŸèƒ½**ï¼š
  - åŸºæœ¬çš„æœƒå“¡ç™»å…¥ã€‚
  - æŸ¥çœ‹æœƒå“¡ç™»å…¥å¾Œçš„æœƒå“¡è³‡æ–™ã€‚
  - æŸ¥çœ‹å€‹äººè³‡æ–™ä»¥åŠé ç´„èª²è¡¨æ¸…å–® (READ)ã€‚
  - æ›´æ”¹/åˆªé™¤é ç´„ (UPDATE / è»Ÿåˆªé™¤)ã€‚
  - æ–°å¢é ç´„ (CREATE)ã€‚
- **æ•™ç·´ç«¯åŠŸèƒ½**ï¼šç›®å‰ç‚ºç„¡ã€‚

---

## ğŸ›  æŠ€è¡“å¯¦ä½œèªªæ˜

### 1. ç™»å…¥ç³»çµ±é‚è¼¯

ç›®å‰ CRUD éƒ¨åˆ†åƒè€ƒæ–°å¾·è€å¸«æ•™å°çš„èªæ³•è£½ä½œã€‚

| åŠŸèƒ½             | å¯¦ä½œç´°ç¯€                                                  | å‚™è¨»                                                        |
| :--------------- | :-------------------------------------------------------- | :---------------------------------------------------------- |
| **ç™»å…¥è™•ç†**     | åœ¨ä¸»ç¨‹å¼ä¸­è§£æ JSON æ•¸æ“šï¼Œä½¿ç”¨ `POST /login` åŸ·è¡Œã€‚       | `SELECT id, name FROM members WHERE email=? AND password=?` |
| **Session å»ºç«‹** | æŸ¥æœ‰è³‡æ–™å¾Œï¼Œå°‡ `id` èˆ‡ `name` å­˜å…¥ `req.session.member`ã€‚ | ä½¿ç”¨ `express-session` ç”Ÿæˆ `connect.sid` cookieã€‚          |
| **å®‰å…¨æ€§**       | é€é `?` å¸¶å…¥åƒæ•¸ï¼Œé¿å… **SQL Injection** é¢¨éšªã€‚          | **å¾…æ”¹é€²**ï¼šå°šæœªå°å¯†ç¢¼ä½¿ç”¨é›œæ¹Šã€æœªè¨­ç½® `httpOnly`ã€‚         |
| **ç™»å‡º**         | éŠ·æ¯€ Session (`req.session.destroy`) ä¸¦é‡å°å‘åˆ°é¦–é ã€‚     |                                                             |

### 2. ç™»å…¥ç‹€æ…‹èˆ‡å°è¦½åˆ—å‘ˆç¾

é€é `express-session` ç®¡ç†ï¼Œä¸¦åœ¨ `app.js` ä¸­å®šç¾©ï¼š

> `res.locals.session = req.session`

- **å‘ˆç¾é‚è¼¯**ï¼šåœ¨ `html-navbar.ejs` ä¸­ä½¿ç”¨ `if...else` èªæ³•ã€‚
- **é¡¯ç¤ºè¦å‰‡**ï¼šè‹¥ `session && session.member` å­˜åœ¨å‰‡å‘ˆç¾é ­åƒï¼Œå¦å‰‡é¡¯ç¤ºç™»å…¥æŒ‰éˆ•ã€‚

### 3. è·¯ç”±ä¿è­·æ©Ÿåˆ¶ (requireMember)

åœ¨æœƒå“¡è³‡æ–™ç›¸é—œè·¯ç”±ä¸­ï¼š

1.  è®€å– `session.member` ä¸¦å®£å‘Šç‚º `mid` (memberid) åƒæ•¸ã€‚
2.  **å®‰å…¨æ©Ÿåˆ¶**ï¼šå¦‚æœæ²’è®€åˆ° session å°±è«‹ä½¿ç”¨è€…è¿”å›ç™»å…¥é é¢ã€‚
